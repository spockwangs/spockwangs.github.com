<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="author" content="" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/stylesheets/base.css" />
    <link rel="stylesheet" href="/stylesheets/screen.css" media="screen" />
    <title>关于Mysql客户端、连接和服务器字符集</title>
  </head>
  <body>
    <header id="header">
      <h1 id="title"><a href="/">Spockwang's Thoughts</a></h1>
    </header>

    <nav id="nav">
      <ul id="menus-wrap">
        <li class="menu first"><a href="/">Archives</a></li>
        <li class="menu"><a href="/about.html">About</a></li>
      </ul>
    </nav>

    <div id="main" class="col-wrapper">
      <div id="content-wrapper" class="col-3-4">
        <div id="content">
          <article id="article">
  <header>
    <h1 class="title">关于Mysql客户端、连接和服务器字符集</h1>
    <div class="meta grid">
      
      <li class="thetag"><a href="/tags/mysql" title='Posts tagged"mysql"'>mysql</a></li>
      
      <li class="thetag"><a href="/tags/character set" title='Posts tagged"character set"'>character set</a></li>
      
      <li class="meta-date right">2013-03-14</li>
    </div>
  </header>
  <div id="toc-wrapper" class="is-invisible">
    <div class="toc-header">Table of Contents</div>
    <div id="toc">
    </div>
  </div>
  <div id="article-content" class="content">
    <h2>Introduction</h2>

<p>Mysql在客户端与服务器交互时涉及到几个字符集和collation的转换问题：</p>

<ul>
<li><p>客户端发给服务器的查询语句的字符集是什么？</p>

<p>客户端发给服务器的语句的字符集由系统变量<a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_character_set_client">character_set_client</a>定义。</p></li>
<li><p>服务器收到查询语句后会转换成什么字符集？</p>

<p>服务器将收到的查询语句从<a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_character_set_client">character_set_client</a>转换为
<a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_character_set_connection">character_set_connection</a>，除非字符串常量显式指定了字符集。系统变量
<a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_collation_connection">collation_connection</a>定义了字符串常量的collation.</p></li>
<li><p>服务器返回给客户端的数据的字符集 是什么？</p>

<p>服务器返回给客户端的数据字符集由系统变量[character_set_results][character_set_results]定义。</p></li>
<li><p>服务器采用什么字符集存储数据？</p>

<p>Mysql中<a href="http://dev.mysql.com/doc/refman/5.5/en/string-types.html">字符串类型</a>有两种。对于非二进制字符串类型（<code>char</code>,
<code>varchar</code>和<code>text</code>）采用建表时指定的字符集存储，对于二进制类型的数据（<code>binary</code>, <code>varbinary</code>, <code>blob</code>, <code>tinyblob</code>,
<code>mediumblob</code>等类型的数据）采用<a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_character_set_connection">character_set_connection</a>定义的字符集所映射的二进制值存储，注
意这些类型本身是没有字符集的。</p></li>
</ul>


<p>上面这些系统变量均是<a href="http://dev.mysql.com/doc/refman/5.0/en/using-system-variables.html">会话变量</a>，改变它们的值不会影响其它客户端与服务器的连接。</p>

<h2>如何设置字符集</h2>

<p>我们通常用<code>set names</code>语句设置连接相关的字符集。</p>

<pre><code>mysql&gt; set names 'charset_name' [collate 'collation_name']
</code></pre>

<p>等价于</p>

<pre><code>mysql&gt; set character_set_client = 'charset_name'
mysql&gt; set character_set_results = 'charset_name'
mysql&gt; set character_set_connection = 'charset_name'
</code></pre>

<h2>如何查看设置的字符集</h2>

<p>可以这样查看设置的系统变量</p>

<pre><code>mysql&gt; show variables like 'character_set%';
+--------------------------+---------------------------------------+
| Variable_name            | Value                                 |
+--------------------------+---------------------------------------+
| character_set_client     | latin1                                | 
| character_set_connection | latin1                                | 
| character_set_database   | latin1                                | 
| character_set_filesystem | binary                                | 
| character_set_results    | latin1                                | 
| character_set_server     | latin1                                | 
| character_set_system     | utf8                                  | 
| character_sets_dir       | /data/mysql_root/base/share/charsets/ | 
+--------------------------+---------------------------------------+
8 rows in set (0.00 sec)
</code></pre>

<h2>References</h2>

<ul>
<li><a href="http://dev.mysql.com/doc/refman/5.5/en/charset-connection.html">关于连接字符集</a>.</li>
<li><a href="http://dev.mysql.com/doc/refman/5.0/en/using-system-variables.html">关于Mysql的两种系统变量</a>.</li>
</ul>


  </div>
  <footer class="footer">
    
    <div class="footer-previous">
      <a href="/2013/03/13/css-best-practice.html" title="Previous post: CSS Best Practice">«CSS Best Practice</a>
    </div>
    
    
    <div class="footer-next">
      <a href="/2013/03/30/object-oriented-analysis-and-design.html" title="Next post: 使用Booch方法进行面向对象分析与设计">使用Booch方法进行面向对象分析与设计»</a>
    </div>
    
  </footer>
</article>

<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'judewang'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        </div>
      </div>
      <div id="sidebar" class="col-1-4">
        <div class="tag-wrapper">
          <h1>Tags</h1>
          <ul class="tag-list">
            
            <li class="tag-item"><span class="thetag"><a href="/tags/Programming/" title='Posts tagged "Programming"'>Programming</a></span>&nbsp;x&nbsp;18</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/quote/" title='Posts tagged "quote"'>quote</a></span>&nbsp;x&nbsp;3</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/Administration/" title='Posts tagged "Administration"'>Administration</a></span>&nbsp;x&nbsp;5</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/programming/" title='Posts tagged "programming"'>programming</a></span>&nbsp;x&nbsp;2</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/Network/" title='Posts tagged "Network"'>Network</a></span>&nbsp;x&nbsp;3</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/css/" title='Posts tagged "css"'>css</a></span>&nbsp;x&nbsp;1</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/mysql/" title='Posts tagged "mysql"'>mysql</a></span>&nbsp;x&nbsp;1</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/character set/" title='Posts tagged "character set"'>character set</a></span>&nbsp;x&nbsp;1</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/object-oriented/" title='Posts tagged "object-oriented"'>object-oriented</a></span>&nbsp;x&nbsp;1</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/concurrency/" title='Posts tagged "concurrency"'>concurrency</a></span>&nbsp;x&nbsp;1</li>
            
          </ul>
        </div>
      </div>
    </div>

    <footer id="footer">
      <p class="copyright">Copyright&nbsp;&copy;&nbsp2013 - judewang - Powered by jekyll</p>
    </footer>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="/javascripts/generate_toc.js"></script>
    <script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
    <script type="text/javascript">
      <!-- Add Google prettify support. -->
      $(function () {
          $("pre > code").addClass("prettyprint");
      });
      </script>
    </div>
  </body>
</html>
