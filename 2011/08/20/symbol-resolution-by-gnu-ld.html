<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="author" content="" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/stylesheets/base.css" />
    <link rel="stylesheet" href="/stylesheets/screen.css" media="screen" />
    <title>Symbol resolution by GNU ld</title>
  </head>
  <body>
    <header id="header">
      <h1 id="title"><a href="/">Spockwang's Thoughts</a></h1>
    </header>

    <nav id="nav">
      <ul id="menus-wrap">
        <li class="menu first"><a href="/">Archives</a></li>
        <li class="menu"><a href="/about.html">About</a></li>
      </ul>
    </nav>

    <div id="main" class="col-wrapper">
      <div id="content-wrapper" class="col-3-4">
        <div id="content">
          <article id="article">
  <header>
    <h1 class="title">Symbol resolution by GNU ld</h1>
    <div class="meta grid">
      
      <li class="thetag"><a href="/tags/Programming" title='Posts tagged"Programming"'>Programming</a></li>
      
      <li class="meta-date right">2011-08-20</li>
    </div>
  </header>
  <div id="toc-wrapper" class="is-invisible">
    <div class="toc-header">Table of Contents</div>
    <div id="toc">
    </div>
  </div>
  <div id="article-content" class="content">
    <h2>Symbol Resolution</h2>
When a symbol appeared multiple times in object files being combined asymbole resolution process is called by the link editor to determine whichsymbol is taken. The resolution of two symbols with the same namedepends on the symbol's attributes (its binding, defineness and size). Seepage 67 of [<a href="#gabi41">Gabi4</a>].

<dl> <dt> Global </dt> <dd>Global symbols are those whose binding is <code>STB_GLOBAL</code>. They are visible to all object files being combined. </dd> <dt> Weak </dt> <dd> Weak symbols are binding is <tt>STB_WEAK</tt>. They resemble global symbols, but their definitions have lower precedence. It can be further categorized into two kinds: undefined weak symbols and defined weak symbols. </dd> <dt> Common </dt> <dd> Common symbols are those whose section index is <tt>STN_COMMON</tt>. They are defined but have not been allocated. Its final size are not determined until the symbol resolution process is complete. </dd> <dt> Undefined </dt> <dd> Undefined symbols are those whose section index is <tt>STN_UNDEF</tt>. </dd> </dl>The rules for symbol resolution is as follows.
<ol>
	<li> If a global symbol exists it can only appeared once in object files being combined. Multipe definitions of global symbols with the same name will cause an error. On the other hand, if a definition of a global symbol eixists, the appearence of weak symbols and/or common symbols with the same name will not cause an error. The link editor honors the global definition and ignores the weak and/or common ones.</li>
	<li> Otherwise, if a common symbol exists, the appearence of weak symbols with the same name will not cause an error. The link editor honors the common definition and ignores the weak ones. If muliple common symbols with the same name exists, the link editor honors the common definition with the biggest size.</li>
	<li> Otherwise, multiple appearences of weak symbols with the same name do not cause an error.
<ol>
	<li> If some of the weak symbols are defined (the section index is a positive integer), the link editor will honor the first found defined symbol and inogre the others.</li>
	<li> Otherwise, if all the weak symbols are undefined, the symbol will be left as an undefined weak symbol in the output file no matter what type of output file is being generated. In addition, if a executable is being generated, all the reference to the symbol will be assigned a value of zero. In the case of dynamic shared object, during process execution, the dynamic linker searches for this symbol. If the dynamic linker does not find a match, it binds a reference to a address of zero instead of generating a fatal runtime relocation error.</li>
</ol>
</li>
</ol>
<h2>Testing Existence of Functionality</h2>
Undefined weak refenrenced symbols may provide a useful mechanism fortesting the existence of functionality. For example, the following C codefragment might have been used in the shared object<tt>libfoo.so.1</tt>:
<pre class="borderindent">#pragma weak foo

extern void foo(char *);

void bar(char *path)
{
    void (*fptr)(char *);
    if ((fptr = foo) != 0)
        (*fptr)(path);
}</pre>
When application is built against <tt>libfoo.so.1</tt>, the link editor willcomplete successfully regardless of whether a definition for the symbol<tt>foo</tt> is found. If during execution of the application the functionaddress tests nonzero, the function is called. However, if the symboldeﬁnition is not found, the function address tests zero and so it is notcalled. See page 45 of [<a href="symbols.html#sun04">Sun04</a>].
<h2>Refenrences</h2>
<ul>
	<li> <a name="gabi4"></a><a href="http://www.sco.com/developers/devspecs/gabi41.pdf">System V ABI Edition 4.1, 1997</a>.</li>
	<li> <a name="sun04"></a>Sun Microsystems, Inc. <a href="http://download.oracle.com/docs/cd/E19683-01/817-3677/817-3677.pdf"><em>Linker and Libraries Guide</em></a>, 2004.</li>
</ul>
<hr /><em>Updated: 2011-03-04 16:14</em>

  </div>
  <footer class="footer">
    
    <div class="footer-previous">
      <a href="/2011/08/20/linux%25e7%25a8%258b%25e5%25ba%258f%25e7%259a%2584%25e5%258a%25a0%25e8%25bd%25bd%25e3%2580%2581%25e8%25bf%2590%25e8%25a1%258c%25e5%2592%258c%25e7%25bb%2588%25e6%25ad%25a2.html" title="Previous post: Linux程序的加载、运行和终止">«Linux程序的加载、运行和终止</a>
    </div>
    
    
    <div class="footer-next">
      <a href="/2011/08/22/typecast-in-c.html" title="Next post: Typecast in C++">Typecast in C++»</a>
    </div>
    
  </footer>
</article>

<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'judewang'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        </div>
      </div>
      <div id="sidebar" class="col-1-4">
        <div class="tag-wrapper">
          <h1>Tags</h1>
          <ul class="tag-list">
            
            <li class="tag-item"><span class="thetag"><a href="/tags/Programming/" title='Posts tagged "Programming"'>Programming</a></span>&nbsp;x&nbsp;19</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/quote/" title='Posts tagged "quote"'>quote</a></span>&nbsp;x&nbsp;3</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/Administration/" title='Posts tagged "Administration"'>Administration</a></span>&nbsp;x&nbsp;5</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/programming/" title='Posts tagged "programming"'>programming</a></span>&nbsp;x&nbsp;2</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/Network/" title='Posts tagged "Network"'>Network</a></span>&nbsp;x&nbsp;3</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/css/" title='Posts tagged "css"'>css</a></span>&nbsp;x&nbsp;1</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/mysql/" title='Posts tagged "mysql"'>mysql</a></span>&nbsp;x&nbsp;1</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/character set/" title='Posts tagged "character set"'>character set</a></span>&nbsp;x&nbsp;1</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/object-oriented/" title='Posts tagged "object-oriented"'>object-oriented</a></span>&nbsp;x&nbsp;1</li>
            
            <li class="tag-item"><span class="thetag"><a href="/tags/concurrency/" title='Posts tagged "concurrency"'>concurrency</a></span>&nbsp;x&nbsp;1</li>
            
          </ul>
        </div>
      </div>
    </div>

    <footer id="footer">
      <p class="copyright">Copyright&nbsp;&copy;&nbsp2013 - judewang - Powered by jekyll</p>
    </footer>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="/javascripts/generate_toc.js"></script>
    <script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
    <script type="text/javascript">
      <!-- Add Google prettify support. -->
      $(function () {
          $("pre > code").addClass("prettyprint");
      });
      </script>
    </div>
  </body>
</html>
